Installation
==================
= Linux:

Configure source tree:
  ./configure

Edit configuration to match your needs:
  vi src/config.h

Build:
  make

Run unit tests
  tests/test

= Solaris:

Set up environment:
  export PATH=/usr/bin:/usr/sbin:/usr/ccs/bin:/usr/sfw/bin
  export LD_LIBRARY_PATH=/usr/local/lib/64:/usr/local/lib:/usr/lib:$LD_LIBRARY_PATH

Configure source tree:
  32 bit ImageMagick:
    ./configure
  64 bit ImageMagick:
    CFLAGS="-m64" LDFLAGS="-m64" GNUMAKE=gmake ./configure

Edit configuration to match your needs:
  vi src/config.h

Build:
  make

Run unit tests
  tests/test  

Apache Configuration
===================

Without sudo support:
  Add something this to your vhost/httpd.conf to serve your thumbnails under http://your.domain/photo/:
    ScriptAlias "/photo" "/var/www/localhost/cgi-bin/cgiscaler"

  Copy executable src/cgiscaler to your Apache cgi-bin directory:
    cp src/cgiscaler /var/www/localhost/cgi-bin

  Prelink with libraries if prelink available:
    prelink --random /var/www/localhost/cgi-bin/cgiscaler

  Reload Apache:
    /etc/init.d/apache reload

With sudo support:
  To use sudo you need to add something like this to your Apache config:
    SuexecUserGroup "kazuya" "users"
  Then add:
    ScriptAlias "/photo" "/var/www/localhost/cgi-bin/scaler/cgiscaler"

  You will need to create new directory under _apache root_ directory (ex. scaler) and make it owned by sudo user and group:
    mkdir /var/www/localhost/cgi-bin/scaler
    chown kazuya:users /var/www/localhost/cgi-bin/scaler

  Copy executable src/cgiscaler to your Apache cgi-bin/scaler directory:
    cp src/cgiscaler /var/www/localhost/cgi-bin/scaler
    chown kazuya:users /var/www/localhost/cgi-bin/scaler/cgiscaler

  Prelink with libraries if prelink available:
    prelink --random /var/www/localhost/cgi-bin/scaler/cgiscaler

  Reload Apache:
    /etc/init.d/apache reload

Non standard library path (usefull with own IM builds or Solaris + 64bit build):
  Add SetEnv to your config, e.x.:
    SetEnv LD_LIBRARY_PATH "/usr/local/lib/64:/usr/local/lib:/usr/lib:$LD_LIBRARY_PATH"

Try it!

http://your.domain/photo/some_image.jpg?w=122&h=200


Performance tips
===================

Build IM with Q8
   ImageMagick can be built witch different quantum depths.
   For thumbnailing purposes there is no need to use quantum depth > 8.
   Bigger quantym depth = higher memory usage, lower speed (more data transferred)

For some performance test you can use:
  httperf --server scaler --num-conn 1000 --ra 200 --timeout 50 --uri=/photo/quick_gimp_pattern_test.png?w=222

